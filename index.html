<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Spy Soft</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
  <link rel="icon" type="image/x-icon" href="spy.webp">
  <!-- <link rel="stylesheet" href="bootstrap/bootstrap.min.css"> -->
  <style>
    body {
      margin: 0;
      font-family: 'Tajawal', sans-serif;
      background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      direction: rtl;
    }
    @media (max-width: 600px) {
      body { padding: 15px; }
    }
    .card {
      background: rgba(255,255,255,0.08);
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
      text-align: center;
      width: 90%;
      max-width: 500px;
      animation: fadeIn 0.6s ease;
      backdrop-filter: blur(10px);
    }
    input, button, select {
      padding: 10px;
      margin: 8px;
      border-radius: 12px;
      border: none;
      font-size: 16px;
    }
    button {
      background: #e94560;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover { background: #dd1a3a; }
    .addButton { background: #4caf50; }
    .addButton:hover { background: #168f1c; }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
    .playerInput{
        background-color: transparent;
        border: 1px solid white;
        color: white;
        outline: none;
        transition: 0.3s;
    }
    .playerInput:focus { border-color: #e94560; }
    .playerInput::placeholder { color: white; }
    #startBtn, #nextBtn , #revealBtn, #resetBtn, #nextVoteBtn { width: 40%; }
    .customSelect {
        background-color: transparent;
        border: 1px solid white;
        color: white;
        outline: none;
        transition: 0.3s;
        border-radius: 12px;
        padding: 10px;
        font-size: 16px;
        width: 100%;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        cursor: pointer;
    }
    .customSelect:focus {
        border-color: #e94560;
    }
    .customSelect option {
        background: #16213e;
        color: white;
    }

    ul { list-style: none; padding: 0; }
    li { margin: 5px 0; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.2); }
    .fade {
      animation: fadeIn 0.6s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="card" id="game"></div>
  <script src="bootstrap/bootstrap.bundle.min.js"></script>
  <script>
    const gameEl = document.getElementById('game');
    let players = [];
    let scores = {};
    let spyIndex = null;
    let secretWord = '';
    let shuffledPlayers = [];
    let words = [
        // üèôÔ∏è ÿ£ŸÖÿßŸÉŸÜ
        "ŸÖÿ∑ÿßÿ±","ŸÖÿØÿ±ÿ≥ÿ©","ŸÖÿ≥ÿ™ÿ¥ŸÅŸâ","ŸÖŸÉÿ™ÿ®ÿ©","ŸÖÿ∑ÿπŸÖ","ŸÖŸÑÿπÿ®","ÿ≥Ÿàÿ®ÿ±ŸÖÿßÿ±ŸÉÿ™","ŸÖÿ≥ÿ¨ÿØ","ŸÉŸÜŸäÿ≥ÿ©","ÿ¨ÿßŸÖÿπÿ©",
        "ÿ≠ÿØŸäŸÇÿ©","ŸÖŸàŸÑ","ÿ≥ŸàŸÇ","ŸÖÿ≠ÿ∑ÿ© ÿ®ŸÜÿ≤ŸäŸÜ","ŸÖÿ≥ÿ±ÿ≠","ÿ≥ŸäŸÜŸÖÿß","ŸÖÿ™ÿ≠ŸÅ","ÿ¥ÿßÿ∑ÿ¶","ŸÖÿÆÿ®ÿ≤","ŸÖŸÇŸáŸâ",
        "ŸÅŸÜÿØŸÇ","ÿ®ÿ±ÿ¨","ŸÇÿµÿ±","ŸÇÿ±Ÿäÿ©","ŸÖÿØŸäŸÜÿ© ŸÖŸÑÿßŸáŸä","ŸÉŸàÿ®ÿ±Ÿä","ŸÜŸÅŸÇ","ŸÖŸàŸÇŸÅ ÿ®ÿßÿµ","ŸÖÿ∑ÿßÿ± ÿπÿ≥ŸÉÿ±Ÿä","ÿ≠ÿ∏Ÿäÿ±ÿ©",
        "ÿ≥ÿ¨ŸÜ","ŸÖŸÉÿ™ÿ® ÿ®ÿ±ŸäÿØ","ŸÖÿ∫ÿ≥ŸÑÿ©","ŸÉÿ±ÿßÿ¨","ŸÖÿ≠ÿ∑ÿ© ŸÇÿ∑ÿßÿ±","ŸÖÿ≥ÿ™ŸàÿØÿπ","ŸÖÿ≤ÿ±ÿπÿ©","ŸÖÿ∑ÿßÿ± ÿÆÿßÿµ","ŸÖŸäŸÜÿßÿ°","ŸÖÿµŸÜÿπ",
        "ŸÖÿ≥ÿ™ÿ¥ŸÅŸâ ÿ£ÿ≥ŸÜÿßŸÜ","ÿµŸäÿØŸÑŸäÿ©","ŸÇÿßÿπÿ© ÿ£ŸÅÿ±ÿßÿ≠","ŸÇÿßÿπÿ© ŸÖÿ§ÿ™ŸÖÿ±ÿßÿ™","ŸÖŸÑÿπÿ® ŸÉÿ±ÿ©","ŸÖÿ≥ÿ®ÿ≠","ÿ≥Ÿàÿ®ÿ± ŸÖÿßÿ±ŸÉÿ™","ŸÖŸÉÿ™ÿ®ÿ© ÿπÿßŸÖÿ©","ÿ∫ÿßÿ®ÿ©","ÿµÿ≠ÿ±ÿßÿ°",

        // ü•ò ÿ£ŸÉŸÑ Ÿàÿ¥ÿ±ÿ®
        "ÿ™ŸÅÿßÿ≠","ŸÖŸàÿ≤","ÿ®ÿ±ÿ™ŸÇÿßŸÑ","ÿπŸÜÿ®","ÿ®ÿ∑ŸäÿÆ","ŸÅÿ±ÿßŸàŸÑÿ©","ŸÉŸäŸàŸä","ŸÉŸÖÿ´ÿ±Ÿâ","ÿ±ŸÖÿßŸÜ","ŸÖÿßŸÜÿ¨ÿß",
        "ÿ£ÿ±ÿ≤","ŸÖŸÉÿ±ŸàŸÜÿ©","ŸÅŸàŸÑ","ÿπÿØÿ≥","ÿ≠ŸÖÿµ","ŸÑÿ≠ŸÖ","ŸÅÿ±ÿßÿÆ","ÿ≥ŸÖŸÉ","ÿ¨ŸÖÿ®ÿ±Ÿä","ŸÉÿ®ÿØÿ©",
        "ÿ®Ÿäÿ™ÿ≤ÿß","ÿ®ÿ±ÿ¨ÿ±","ÿ¥ÿßŸàÿ±ŸÖÿß","ŸÉÿ¥ÿ±Ÿä","ÿ∑ÿπŸÖŸäÿ©","ÿ≥ÿßŸÜÿØŸàŸäÿ™ÿ¥","ÿ®Ÿäÿ∂","ÿ¨ÿ®ŸÜÿ©","ŸÑÿ®ŸÜ","ÿ≤Ÿäÿ™ŸàŸÜ",
        "ÿπÿµŸäÿ± ÿ®ÿ±ÿ™ŸÇÿßŸÑ","ÿ¥ÿßŸä","ŸÇŸáŸàÿ©","ŸÜÿ≥ŸÉÿßŸÅŸäŸá","ÿ®Ÿäÿ®ÿ≥Ÿä","ŸÖŸäÿßŸá ÿ∫ÿßÿ≤Ÿäÿ©","ÿ≠ŸÑŸäÿ®","ÿ≤ÿ®ÿßÿØŸä","ŸÉÿßŸÉÿßŸà","ÿ¥ŸàŸÉŸàŸÑÿßÿ™ÿ©",

        // üéÆ ÿ£ŸÑÿπÿßÿ® Ÿàÿ£ŸÜÿ¥ÿ∑ÿ©
        "ÿ¥ÿ∑ÿ±ŸÜÿ¨","ÿØŸàŸÖŸäŸÜŸà","ÿ∑ÿßŸàŸÑÿ©","ŸÉŸàÿ™ÿ¥ŸäŸÜÿ©","ÿ®ŸÑŸäÿßÿ±ÿØŸà","ŸÉÿ±ÿ© ÿ≥ŸÑÿ©","ŸÉÿ±ÿ© ŸäÿØ","ŸÉÿ±ÿ© ŸÇÿØŸÖ","ÿ™ŸÜÿ≥","ÿßÿ≥ŸÉŸàÿßÿ¥",
        "ÿ≥ÿ®ÿßÿ≠ÿ©","ÿ¨ÿ±Ÿä","ŸÇŸÅÿ≤","ÿ™ÿ≥ŸÑŸÇ","ÿ±ŸÖÿßŸäÿ©","ÿ®ŸàŸÑŸäŸÜÿ¨","ÿ®ŸÑŸäÿ≥ÿ™Ÿäÿ¥ŸÜ","ŸÜŸäŸÜÿ™ŸÜÿØŸà","ÿ£ŸÑÿπÿßÿ® Ÿàÿ±ŸÇ","ÿ®ÿßÿ≤ŸÑ",
        "ŸÑŸäÿ¨Ÿà","ÿ∫ŸÖŸäÿ∂ÿ©","ÿßÿ≥ÿ™ÿ∫ŸÖÿßŸäÿ©","ŸÉÿ±ÿßÿ≥Ÿä ŸÖŸàÿ≥ŸäŸÇŸäÿ©","ŸÖÿ≥ÿßÿ®ŸÇÿ©","ÿ±ÿ≥ŸÖ","ÿ∫ŸÜÿßÿ°","ÿ±ŸÇÿµ","ÿ™ŸÖÿ´ŸäŸÑ","ÿπÿ≤ŸÅ",

        // üèÄ ÿ±Ÿäÿßÿ∂ÿßÿ™
        "ŸÉÿßÿ±ÿßÿ™ŸäŸá","ÿ¨ŸàÿØŸà","ŸÉŸàŸÜÿ∫ ŸÅŸà","ŸÖŸÑÿßŸÉŸÖÿ©","ŸÖÿµÿßÿ±ÿπÿ©","ÿ™ÿßŸäŸÉŸàŸÜÿØŸà","ŸÅÿ±Ÿàÿ≥Ÿäÿ©","ÿØÿ±ÿßÿ¨ÿßÿ™","ÿ±ŸÉŸàÿ® ÿÆŸäŸÑ","ÿ±ŸÖÿßŸäÿ© ÿ≥ŸáÿßŸÖ",
        "ŸáŸàŸÉŸä","ŸÉÿ±ŸäŸÉÿ™","ÿ±ÿ¨ÿ®Ÿä","ÿ®Ÿäÿ≥ÿ®ŸàŸÑ","ÿ¨ŸàŸÑŸÅ","ÿ≥Ÿäÿ±ŸÉ","ÿ™ÿ≥ŸÑŸÇ ÿ¨ÿ®ÿßŸÑ","ŸÇŸÅÿ≤ ŸÖÿ∏ŸÑÿßÿ™","ÿ±ŸÉŸàÿ® ÿ£ŸÖŸàÿßÿ¨","ÿ≤ŸàŸÖÿ®ÿß",

        // üè¢ ÿ£ŸÖÿßŸÉŸÜ ÿπŸÖŸÑ
        "ÿ¥ÿ±ŸÉÿ©","ŸÖŸÉÿ™ÿ®","ÿ®ŸÜŸÉ","ŸÖÿ≥ÿ™ÿ¥ŸÅŸâ ÿÆÿßÿµ","ŸÖÿØÿ±ÿ≥ÿ© ÿØŸàŸÑŸäÿ©","ÿ¨ÿßŸÖÿπÿ© ÿÆÿßÿµÿ©","ŸÖÿµŸÜÿπ ÿ≥Ÿäÿßÿ±ÿßÿ™","Ÿàÿ±ÿ¥ÿ© ŸÜÿ¨ÿßÿ±ÿ©","Ÿàÿ±ÿ¥ÿ© ÿ≠ÿØÿßÿØÿ©","ŸÖÿ∑ÿ®ÿπÿ©",
        "ŸÖÿ≠ŸÉŸÖÿ©","Ÿàÿ≤ÿßÿ±ÿ©","ÿ≥ŸÅÿßÿ±ÿ©","ŸÖÿ±ŸÉÿ≤ ÿ¥ÿ±ÿ∑ÿ©","ŸÖÿ∑ÿπŸÖ ŸÅÿßÿÆÿ±","ŸÉÿßŸÅŸäŸá","ŸÖÿÆÿ®ÿ≤","ÿ≥Ÿàÿ®ÿ± ŸÖÿßÿ±ŸÉÿ™ ŸÉÿ®Ÿäÿ±","ŸÖŸÉÿ™ÿ®ÿ© ŸÖÿØÿ±ÿ≥Ÿäÿ©","ŸÅÿµŸÑ ÿØÿ±ÿßÿ≥Ÿä",
        "ŸÖÿπŸÖŸÑ ÿ™ÿ≠ÿßŸÑŸäŸÑ","ŸÖÿπŸÖŸÑ ŸÉŸäŸÖŸäÿßÿ°","ÿ∫ÿ±ŸÅÿ© ÿπŸÖŸÑŸäÿßÿ™","ÿ≠ÿ∂ÿßŸÜÿ© ÿ£ÿ∑ŸÅÿßŸÑ","ÿØÿßÿ± ÿ£Ÿäÿ™ÿßŸÖ","ŸÖÿ±ŸÉÿ≤ ÿ¥ÿ®ÿßÿ®","ŸÇÿßÿπÿ© ÿ≠ŸÅŸÑÿßÿ™","ÿ¥ÿ±ŸÉÿ© ÿ™ŸÉŸÜŸàŸÑŸàÿ¨Ÿäÿß","ŸÖÿ≤ÿ±ÿπÿ© ÿØŸàÿßÿ¨ŸÜ","ŸÖÿπÿ±ÿ∂ ÿ≥Ÿäÿßÿ±ÿßÿ™",

        // üé∂ ŸÅŸÜ ŸàŸÖŸàÿ≥ŸäŸÇŸâ
        "ÿ¨Ÿäÿ™ÿßÿ±","ÿ®ŸäÿßŸÜŸà","ÿ∑ÿ®ŸÑÿ©","ÿπŸàÿØ","ŸÜÿßŸä","ŸÉŸÖÿßŸÜ","ÿØŸÅ","ŸÖÿ≤ŸÖÿßÿ±","ÿ≥ÿßŸÉÿ≥ŸÅŸàŸÜ","ÿ™ÿ±ŸàŸÖÿ®Ÿäÿ™",
        "ŸÖÿßŸäŸÉÿ±ŸàŸÅŸàŸÜ","ÿ£ÿ≥ÿ™ŸàÿØŸäŸà","ÿ£ÿ∫ŸÜŸäÿ©","ŸÅÿ±ŸÇÿ© ŸÖŸàÿ≥ŸäŸÇŸäÿ©","ÿ≠ŸÅŸÑ","ŸÖŸáÿ±ÿ¨ÿßŸÜ","ÿØŸä ÿ¨Ÿä","ÿ±ŸÇÿµÿ©","ŸÑŸàÿ≠ÿ©","ÿ™ŸÖÿ´ÿßŸÑ",

        // üêæ ÿ∑ÿ®Ÿäÿπÿ© Ÿàÿ≠ŸäŸàÿßŸÜÿßÿ™
        "ŸÇÿ∑ÿ©","ŸÉŸÑÿ®","ÿ≠ÿµÿßŸÜ","ÿ¨ŸÖŸÑ","ÿ®ŸÇÿ±ÿ©","ÿ¨ÿßŸÖŸàÿ≥ÿ©","ÿ∫ŸÜŸÖ","ŸÖÿßÿπÿ≤","ÿ®ÿ∑ÿ©","Ÿàÿ≤ÿ©",
        "ÿ≥ŸÖŸÉÿ©","„Ç§„É´ŸÉÿß","ÿ≠Ÿàÿ™","ÿ™ŸÖÿ≥ÿßÿ≠","ÿ´ÿπÿ®ÿßŸÜ","ÿπÿµŸÅŸàÿ±","ŸÜÿ≥ÿ±","ÿ®ŸàŸÖÿ©","ÿ≠ŸÖÿßŸÖÿ©","ÿ∫ÿ±ÿßÿ®",
        "ÿ¥ÿ¨ÿ±ÿ©","ŸÜÿÆŸÑÿ©","ÿ≤Ÿáÿ±ÿ©","Ÿàÿ±ÿØÿ©","ÿµÿ®ÿßÿ±","ÿ∫ÿßÿ®ÿ©","ÿµÿ≠ÿ±ÿßÿ°","ŸÜŸáÿ±","ÿ®ÿ≠Ÿäÿ±ÿ©","ÿ¨ÿ®ŸÑ",

        // ÿ•ÿ∂ÿßŸÅÿßÿ™ ÿπÿßŸÖÿ©
        "ŸÉŸÖÿ®ŸäŸàÿ™ÿ±","ŸÖŸàÿ®ÿßŸäŸÑ","ÿ™ŸÑŸÅÿ≤ŸäŸàŸÜ","ÿ±ÿßÿØŸäŸà","ŸÉÿßŸÖŸäÿ±ÿß","ŸÉÿ™ÿßÿ®","ÿØŸÅÿ™ÿ±","ŸÇŸÑŸÖ","ŸÉÿ±ÿ≥Ÿä","ÿ∑ÿßŸàŸÑÿ©",
        "ÿ®ÿßÿ®","ÿ¥ÿ®ÿßŸÉ","ÿ≥ŸÇŸÅ","ÿ≠ÿßÿ¶ÿ∑","ÿ≥ÿ¨ÿßÿØÿ©","ŸÖÿ±Ÿàÿ≠ÿ©","ÿ™ŸÉŸäŸäŸÅ","ÿ´ŸÑÿßÿ¨ÿ©","ÿ∫ÿ≥ÿßŸÑÿ©","ÿ®Ÿàÿ™ÿ¨ÿßÿ≤"
        ];
    let votes = {};

    if (sessionStorage.getItem('players')) {
      players = JSON.parse(sessionStorage.getItem('players'));
      scores = JSON.parse(sessionStorage.getItem('scores'));
    }
    function applyAnimation() {
      gameEl.classList.remove('fade');
      void gameEl.offsetWidth;
      gameEl.classList.add('fade');
    }

    function shuffleArray(arr) {
      let a = [...arr];
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function startScreen() {
      gameEl.innerHTML = `
        <h2>ÿ£ÿØÿÆŸÑ ÿ£ÿ≥ŸÖÿßÿ° ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ</h2>
        <input type="text" class="playerInput" id="playerName" placeholder="ÿßÿ≥ŸÖ ÿßŸÑŸÑÿßÿπÿ®" />
        <button class="addButton" onclick="addPlayer()">ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÑÿßÿπÿ®</button>
        <ul id="playersList"></ul>
        <button id="startBtn" onclick="startGame()" disabled>ÿßÿ®ÿØÿ£ ÿßŸÑŸÑÿπÿ®ÿ©</button>
        <button id="resetBtn" onclick="resetGame()">üîÑ ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÑÿπÿ®ÿ©</button>

      `;
      updatePlayersList();
      toggleStartButton();
      applyAnimation();
    }

    function addPlayer() {
      const name = document.getElementById('playerName').value.trim();
      if (name) {
        players.push(name);
        scores[name] = scores[name] || 0;
        document.getElementById('playerName').value = '';
        saveSession();
        updatePlayersList();
        toggleStartButton();
        applyAnimation();
      }
    }

    function updatePlayersList() {
      const list = document.getElementById('playersList');
      if (list) list.innerHTML = players.map(p => `<li>${p}</li>`).join('');
    }

    function toggleStartButton() {
      const btn = document.getElementById('startBtn');
      if (btn) btn.disabled = players.length < 3;
    }

    function saveSession() {
      sessionStorage.setItem('players', JSON.stringify(players));
      sessionStorage.setItem('scores', JSON.stringify(scores));
    }

    function startGame() {
      if (players.length < 3) {
        alert("ŸÑÿßÿ≤ŸÖ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ 3 ŸÑÿßÿπÿ®ŸäŸÜ");
        return;
      }
      secretWord = words[Math.floor(Math.random() * words.length)];
      spyIndex = Math.floor(Math.random() * players.length);
      shuffledPlayers = shuffleArray(players);
      showPassScreen(0);
    }

    function showPassScreen(i) {
      gameEl.innerHTML = `
        <h2>ÿßŸÑÿØŸàÿ±: ${shuffledPlayers[i]}</h2>
        <p>ÿ£ÿπÿ∑Ÿê ÿßŸÑŸáÿßÿ™ŸÅ ŸÑŸÑÿßÿπÿ®</p>
        <button id="nextBtn" onclick="showRole(${i})">ÿ¨ÿßŸáÿ≤</button>
      `;
      applyAnimation();
    }

    function showRole(i) {
      const playerName = shuffledPlayers[i];
      const isSpy = (players.indexOf(playerName) === spyIndex);
      gameEl.innerHTML = `
        <h2>ÿßŸÑÿØŸàÿ±: ${playerName}</h2>
        <p>${isSpy ? "ÿ£ŸÜÿ™ ÿßŸÑÿ¨ÿßÿ≥Ÿàÿ≥ üïµÔ∏è" : "ÿßŸÑŸÉŸÑŸÖÿ©: <b>" + secretWord + "</b>"}</p>
        <button id="nextBtn" onclick="nextRole(${i})">ÿ™ŸÖÿßŸÖ</button>
      `;
      applyAnimation();
    }

    function nextRole(i) {
      if (i + 1 < shuffledPlayers.length) {
        showPassScreen(i + 1);
      } else {
        startVotingIntro();
      }
      applyAnimation();
    }

    // function startVoting() {
    //   votes = {};
    //   gameEl.innerHTML = `<h2>ÿßŸÑÿ™ÿµŸàŸäÿ™: ŸÖŸäŸÜ ÿßŸÑÿ¨ÿßÿ≥Ÿàÿ≥ÿü</h2>`;
    //   players.forEach(p => {
    //     gameEl.innerHTML += `
    //       <p>${p} ŸäÿÆÿ™ÿßÿ±:
    //         <select id="vote_${p}" class="customSelect" onchange="checkVotes()">
    //           <option value="">-- ÿßÿÆÿ™ÿ± --</option>
    //           ${players.filter(op => op !== p).map(op => `<option>${op}</option>`).join('')}
    //         </select>
    //       </p>`;
    //   });
    //   gameEl.innerHTML += `<button id="revealBtn" onclick="showResult()" disabled>ŸÖŸäŸÜ ÿßŸÑÿ¨ÿßÿ≥Ÿàÿ≥ÿü</button>`;
    // }

    function checkVotes() {
      let allChosen = true;
      players.forEach(p => {
        const val = document.getElementById('vote_' + p).value;
        if (!val) allChosen = false;
      });
      document.getElementById('revealBtn').disabled = !allChosen;
    }


    function startVotingIntro() {
  gameEl.innerHTML = `
    <h2>üì¢ ŸàŸÇÿ™ ÿßŸÑÿ™ÿµŸàŸäÿ™</h2>
    <p>ŸáŸäŸÖÿ≥ŸÉ ŸÉŸÑ ŸÑÿßÿπÿ® ÿßŸÑŸÖŸàÿ®ÿßŸäŸÑ ÿπÿ¥ÿßŸÜ ŸäÿÆÿ™ÿßÿ± ŸÖŸäŸÜ ÿßŸÑÿ¨ÿßÿ≥Ÿàÿ≥ ŸÖŸÜ ÿ∫Ÿäÿ± ŸÖÿß ÿ≠ÿØ Ÿäÿ¥ŸàŸÅ</p>
    <button onclick="showVoting(0)">ÿßÿ®ÿØÿ£ ÿßŸÑÿ™ÿµŸàŸäÿ™</button>
  `;
  applyAnimation();
}

function showVoting(i) {
  const player = players[i];
  gameEl.innerHTML = `
    <h2>ÿ™ÿµŸàŸäÿ™: ${player}</h2>
    <p>ÿßÿÆÿ™ÿ± ŸÖŸäŸÜ ÿ™ÿ∏ŸÜ ÿßŸÜŸá ÿßŸÑÿ¨ÿßÿ≥Ÿàÿ≥ üïµÔ∏è</p>
    <select id="vote_${player}" class="customSelect">
      <option value="">-- ÿßÿÆÿ™ÿ± --</option>
      ${players.filter(op => op !== player).map(op => `<option>${op}</option>`).join('')}
    </select>
    <br>
    <button id="nextVoteBtn" onclick="saveVote('${player}', ${i})">ÿ™ŸÖÿßŸÖ</button>
  `;
  applyAnimation();
}

function saveVote(player, i) {
  const val = document.getElementById('vote_' + player).value;
  if (!val) {
    alert("ŸÑÿßÿ≤ŸÖ ÿ™ÿÆÿ™ÿßÿ± ÿ≠ÿØ");
    return;
  }
  votes[player] = val;

  if (i + 1 < players.length) {
    showVoting(i + 1);
  } else {
    gameEl.innerHTML = `
      <h2>ÿ™ŸÖ ÿßŸÑÿ™ÿµŸàŸäÿ™ ‚úÖ</h2>
      <p>ÿßÿ∂ÿ∫ÿ∑ ŸÑŸÖÿπÿ±ŸÅÿ© ŸÖŸäŸÜ ÿßŸÑÿ¨ÿßÿ≥Ÿàÿ≥</p>
      <button id="revealBtn" onclick="showResult()">ŸÖŸäŸÜ ÿßŸÑÿ¨ÿßÿ≥Ÿàÿ≥ÿü</button>
    `;
    applyAnimation();
  }
}


function showResult() {
  const spyName = players[spyIndex];
  let resultHTML = `<h2>ÿßŸÑÿ¨ÿßÿ≥Ÿàÿ≥ ŸáŸà: ${spyName}</h2>`;

  players.forEach(p => {
    if (votes[p] === spyName) {
      scores[p] += 100;
    } else if (p === spyName && !Object.values(votes).includes(spyName)) {
      scores[p] += 100;
    }
  });

  saveSession();

  let sorted = Object.entries(scores).sort((a,b) => b[1] - a[1]);
  resultHTML += `<h3>ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨:</h3><table>`;
  sorted.forEach(([name, score], idx) => {
    resultHTML += `<tr><td>${idx+1}</td><td>${name}</td><td>${score}</td></tr>`;
  });
  resultHTML += `</table>`;
  resultHTML += `
    <button onclick="startGame()">ÿØŸàÿ± ÿ¨ÿØŸäÿØ</button>
    <button onclick="resetGame()">üîÑ ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÑÿπÿ®ÿ©</button>
  `;
  gameEl.innerHTML = resultHTML;
  applyAnimation();
}


    function resetGame() {
      if (confirm("ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ÿ£ŸÜŸÉ ÿ™ÿ±ŸäÿØ ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÑÿπÿ®ÿ© ŸÖŸÜ ÿßŸÑÿ®ÿØÿßŸäÿ©ÿü")) {
        sessionStorage.clear();
        players = [];
        scores = {};
        startScreen();
        applyAnimation();
      }
    }

    startScreen();
  </script>
</body>
</html>
