<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Spy Soft</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
  <link rel="icon" type="image/x-icon" href="spy.webp">
  <!-- <link rel="stylesheet" href="bootstrap/bootstrap.min.css"> -->
  <style>
    body {
      margin: 0;
      font-family: 'Tajawal', sans-serif;
      background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      direction: rtl;
    }
    @media (max-width: 600px) {
      body { padding: 15px; }
    }
    .card {
      background: rgba(255,255,255,0.08);
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
      text-align: center;
      width: 90%;
      max-width: 500px;
      animation: fadeIn 0.6s ease;
      backdrop-filter: blur(10px);
    }
    input, button, select {
      padding: 10px;
      margin: 8px;
      border-radius: 12px;
      border: none;
      font-size: 16px;
    }
    button {
      background: #e94560;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover { background: #dd1a3a; }
    .addButton { background: #4caf50; }
    .addButton:hover { background: #168f1c; }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
    .playerInput{
        background-color: transparent;
        border: 1px solid white;
        color: white;
        outline: none;
        transition: 0.3s;
    }
    .playerInput:focus { border-color: #e94560; }
    .playerInput::placeholder { color: white; }
    #startBtn, #nextBtn , #revealBtn, #resetBtn, #nextVoteBtn { width: 40%; }
    .customSelect {
        background-color: transparent;
        border: 1px solid white;
        color: white;
        outline: none;
        transition: 0.3s;
        border-radius: 12px;
        padding: 10px;
        font-size: 16px;
        width: 100%;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        cursor: pointer;
    }
    .customSelect:focus {
        border-color: #e94560;
    }
    .customSelect option {
        background: #16213e;
        color: white;
    }

    ul { list-style: none; padding: 0; }
    li { margin: 5px 0; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.2); }
    .fade {
      animation: fadeIn 0.6s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="card" id="game"></div>
  <script src="bootstrap/bootstrap.bundle.min.js"></script>
  <script>
    const gameEl = document.getElementById('game');
    let players = [];
    let scores = {};
    let spyIndex = null;
    let secretWord = '';
    let shuffledPlayers = [];
    let words = [
        // ğŸ™ï¸ Ø£Ù…Ø§ÙƒÙ†
        "Ù…Ø·Ø§Ø±","Ù…Ø¯Ø±Ø³Ø©","Ù…Ø³ØªØ´ÙÙ‰","Ù…ÙƒØªØ¨Ø©","Ù…Ø·Ø¹Ù…","Ù…Ù„Ø¹Ø¨","Ø³ÙˆØ¨Ø±Ù…Ø§Ø±ÙƒØª","Ù…Ø³Ø¬Ø¯","ÙƒÙ†ÙŠØ³Ø©","Ø¬Ø§Ù…Ø¹Ø©",
        "Ø­Ø¯ÙŠÙ‚Ø©","Ù…ÙˆÙ„","Ø³ÙˆÙ‚","Ù…Ø­Ø·Ø© Ø¨Ù†Ø²ÙŠÙ†","Ù…Ø³Ø±Ø­","Ø³ÙŠÙ†Ù…Ø§","Ù…ØªØ­Ù","Ø´Ø§Ø·Ø¦","Ù…Ø®Ø¨Ø²","Ù…Ù‚Ù‡Ù‰",
        "ÙÙ†Ø¯Ù‚","Ø¨Ø±Ø¬","Ù‚ØµØ±","Ù‚Ø±ÙŠØ©","Ù…Ø¯ÙŠÙ†Ø© Ù…Ù„Ø§Ù‡ÙŠ","ÙƒÙˆØ¨Ø±ÙŠ","Ù†ÙÙ‚","Ù…ÙˆÙ‚Ù Ø¨Ø§Øµ","Ù…Ø·Ø§Ø± Ø¹Ø³ÙƒØ±ÙŠ","Ø­Ø¸ÙŠØ±Ø©",
        "Ø³Ø¬Ù†","Ù…ÙƒØªØ¨ Ø¨Ø±ÙŠØ¯","Ù…ØºØ³Ù„Ø©","ÙƒØ±Ø§Ø¬","Ù…Ø­Ø·Ø© Ù‚Ø·Ø§Ø±","Ù…Ø³ØªÙˆØ¯Ø¹","Ù…Ø²Ø±Ø¹Ø©","Ù…Ø·Ø§Ø± Ø®Ø§Øµ","Ù…ÙŠÙ†Ø§Ø¡","Ù…ØµÙ†Ø¹",
        "Ù…Ø³ØªØ´ÙÙ‰ Ø£Ø³Ù†Ø§Ù†","ØµÙŠØ¯Ù„ÙŠØ©","Ù‚Ø§Ø¹Ø© Ø£ÙØ±Ø§Ø­","Ù‚Ø§Ø¹Ø© Ù…Ø¤ØªÙ…Ø±Ø§Øª","Ù…Ù„Ø¹Ø¨ ÙƒØ±Ø©","Ù…Ø³Ø¨Ø­","Ø³ÙˆØ¨Ø± Ù…Ø§Ø±ÙƒØª","Ù…ÙƒØªØ¨Ø© Ø¹Ø§Ù…Ø©","ØºØ§Ø¨Ø©","ØµØ­Ø±Ø§Ø¡",

        // ğŸ¥˜ Ø£ÙƒÙ„ ÙˆØ´Ø±Ø¨
        "ØªÙØ§Ø­","Ù…ÙˆØ²","Ø¨Ø±ØªÙ‚Ø§Ù„","Ø¹Ù†Ø¨","Ø¨Ø·ÙŠØ®","ÙØ±Ø§ÙˆÙ„Ø©","ÙƒÙŠÙˆÙŠ","ÙƒÙ…Ø«Ø±Ù‰","Ø±Ù…Ø§Ù†","Ù…Ø§Ù†Ø¬Ø§",
        "Ø£Ø±Ø²","Ù…ÙƒØ±ÙˆÙ†Ø©","ÙÙˆÙ„","Ø¹Ø¯Ø³","Ø­Ù…Øµ","Ù„Ø­Ù…","ÙØ±Ø§Ø®","Ø³Ù…Ùƒ","Ø¬Ù…Ø¨Ø±ÙŠ","ÙƒØ¨Ø¯Ø©",
        "Ø¨ÙŠØªØ²Ø§","Ø¨Ø±Ø¬Ø±","Ø´Ø§ÙˆØ±Ù…Ø§","ÙƒØ´Ø±ÙŠ","Ø·Ø¹Ù…ÙŠØ©","Ø³Ø§Ù†Ø¯ÙˆÙŠØªØ´","Ø¨ÙŠØ¶","Ø¬Ø¨Ù†Ø©","Ù„Ø¨Ù†","Ø²ÙŠØªÙˆÙ†",
        "Ø¹ØµÙŠØ± Ø¨Ø±ØªÙ‚Ø§Ù„","Ø´Ø§ÙŠ","Ù‚Ù‡ÙˆØ©","Ù†Ø³ÙƒØ§ÙÙŠÙ‡","Ø¨ÙŠØ¨Ø³ÙŠ","Ù…ÙŠØ§Ù‡ ØºØ§Ø²ÙŠØ©","Ø­Ù„ÙŠØ¨","Ø²Ø¨Ø§Ø¯ÙŠ","ÙƒØ§ÙƒØ§Ùˆ","Ø´ÙˆÙƒÙˆÙ„Ø§ØªØ©",

        // ğŸ® Ø£Ù„Ø¹Ø§Ø¨ ÙˆØ£Ù†Ø´Ø·Ø©
        "Ø´Ø·Ø±Ù†Ø¬","Ø¯ÙˆÙ…ÙŠÙ†Ùˆ","Ø·Ø§ÙˆÙ„Ø©","ÙƒÙˆØªØ´ÙŠÙ†Ø©","Ø¨Ù„ÙŠØ§Ø±Ø¯Ùˆ","ÙƒØ±Ø© Ø³Ù„Ø©","ÙƒØ±Ø© ÙŠØ¯","ÙƒØ±Ø© Ù‚Ø¯Ù…","ØªÙ†Ø³","Ø§Ø³ÙƒÙˆØ§Ø´",
        "Ø³Ø¨Ø§Ø­Ø©","Ø¬Ø±ÙŠ","Ù‚ÙØ²","ØªØ³Ù„Ù‚","Ø±Ù…Ø§ÙŠØ©","Ø¨ÙˆÙ„ÙŠÙ†Ø¬","Ø¨Ù„ÙŠØ³ØªÙŠØ´Ù†","Ù†ÙŠÙ†ØªÙ†Ø¯Ùˆ","Ø£Ù„Ø¹Ø§Ø¨ ÙˆØ±Ù‚","Ø¨Ø§Ø²Ù„",
        "Ù„ÙŠØ¬Ùˆ","ØºÙ…ÙŠØ¶Ø©","Ø§Ø³ØªØºÙ…Ø§ÙŠØ©","ÙƒØ±Ø§Ø³ÙŠ Ù…ÙˆØ³ÙŠÙ‚ÙŠØ©","Ù…Ø³Ø§Ø¨Ù‚Ø©","Ø±Ø³Ù…","ØºÙ†Ø§Ø¡","Ø±Ù‚Øµ","ØªÙ…Ø«ÙŠÙ„","Ø¹Ø²Ù",

        // ğŸ€ Ø±ÙŠØ§Ø¶Ø§Øª
        "ÙƒØ§Ø±Ø§ØªÙŠÙ‡","Ø¬ÙˆØ¯Ùˆ","ÙƒÙˆÙ†Øº ÙÙˆ","Ù…Ù„Ø§ÙƒÙ…Ø©","Ù…ØµØ§Ø±Ø¹Ø©","ØªØ§ÙŠÙƒÙˆÙ†Ø¯Ùˆ","ÙØ±ÙˆØ³ÙŠØ©","Ø¯Ø±Ø§Ø¬Ø§Øª","Ø±ÙƒÙˆØ¨ Ø®ÙŠÙ„","Ø±Ù…Ø§ÙŠØ© Ø³Ù‡Ø§Ù…",
        "Ù‡ÙˆÙƒÙŠ","ÙƒØ±ÙŠÙƒØª","Ø±Ø¬Ø¨ÙŠ","Ø¨ÙŠØ³Ø¨ÙˆÙ„","Ø¬ÙˆÙ„Ù","Ø³ÙŠØ±Ùƒ","ØªØ³Ù„Ù‚ Ø¬Ø¨Ø§Ù„","Ù‚ÙØ² Ù…Ø¸Ù„Ø§Øª","Ø±ÙƒÙˆØ¨ Ø£Ù…ÙˆØ§Ø¬","Ø²ÙˆÙ…Ø¨Ø§",

        // ğŸ¢ Ø£Ù…Ø§ÙƒÙ† Ø¹Ù…Ù„
        "Ø´Ø±ÙƒØ©","Ù…ÙƒØªØ¨","Ø¨Ù†Ùƒ","Ù…Ø³ØªØ´ÙÙ‰ Ø®Ø§Øµ","Ù…Ø¯Ø±Ø³Ø© Ø¯ÙˆÙ„ÙŠØ©","Ø¬Ø§Ù…Ø¹Ø© Ø®Ø§ØµØ©","Ù…ØµÙ†Ø¹ Ø³ÙŠØ§Ø±Ø§Øª","ÙˆØ±Ø´Ø© Ù†Ø¬Ø§Ø±Ø©","ÙˆØ±Ø´Ø© Ø­Ø¯Ø§Ø¯Ø©","Ù…Ø·Ø¨Ø¹Ø©",
        "Ù…Ø­ÙƒÙ…Ø©","ÙˆØ²Ø§Ø±Ø©","Ø³ÙØ§Ø±Ø©","Ù…Ø±ÙƒØ² Ø´Ø±Ø·Ø©","Ù…Ø·Ø¹Ù… ÙØ§Ø®Ø±","ÙƒØ§ÙÙŠÙ‡","Ù…Ø®Ø¨Ø²","Ø³ÙˆØ¨Ø± Ù…Ø§Ø±ÙƒØª ÙƒØ¨ÙŠØ±","Ù…ÙƒØªØ¨Ø© Ù…Ø¯Ø±Ø³ÙŠØ©","ÙØµÙ„ Ø¯Ø±Ø§Ø³ÙŠ",
        "Ù…Ø¹Ù…Ù„ ØªØ­Ø§Ù„ÙŠÙ„","Ù…Ø¹Ù…Ù„ ÙƒÙŠÙ…ÙŠØ§Ø¡","ØºØ±ÙØ© Ø¹Ù…Ù„ÙŠØ§Øª","Ø­Ø¶Ø§Ù†Ø© Ø£Ø·ÙØ§Ù„","Ø¯Ø§Ø± Ø£ÙŠØªØ§Ù…","Ù…Ø±ÙƒØ² Ø´Ø¨Ø§Ø¨","Ù‚Ø§Ø¹Ø© Ø­ÙÙ„Ø§Øª","Ø´Ø±ÙƒØ© ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§","Ù…Ø²Ø±Ø¹Ø© Ø¯ÙˆØ§Ø¬Ù†","Ù…Ø¹Ø±Ø¶ Ø³ÙŠØ§Ø±Ø§Øª",

        // ğŸ¶ ÙÙ† ÙˆÙ…ÙˆØ³ÙŠÙ‚Ù‰
        "Ø¬ÙŠØªØ§Ø±","Ø¨ÙŠØ§Ù†Ùˆ","Ø·Ø¨Ù„Ø©","Ø¹ÙˆØ¯","Ù†Ø§ÙŠ","ÙƒÙ…Ø§Ù†","Ø¯Ù","Ù…Ø²Ù…Ø§Ø±","Ø³Ø§ÙƒØ³ÙÙˆÙ†","ØªØ±ÙˆÙ…Ø¨ÙŠØª",
        "Ù…Ø§ÙŠÙƒØ±ÙˆÙÙˆÙ†","Ø£Ø³ØªÙˆØ¯ÙŠÙˆ","Ø£ØºÙ†ÙŠØ©","ÙØ±Ù‚Ø© Ù…ÙˆØ³ÙŠÙ‚ÙŠØ©","Ø­ÙÙ„","Ù…Ù‡Ø±Ø¬Ø§Ù†","Ø¯ÙŠ Ø¬ÙŠ","Ø±Ù‚ØµØ©","Ù„ÙˆØ­Ø©","ØªÙ…Ø«Ø§Ù„",

        // ğŸ¾ Ø·Ø¨ÙŠØ¹Ø© ÙˆØ­ÙŠÙˆØ§Ù†Ø§Øª
        "Ù‚Ø·Ø©","ÙƒÙ„Ø¨","Ø­ØµØ§Ù†","Ø¬Ù…Ù„","Ø¨Ù‚Ø±Ø©","Ø¬Ø§Ù…ÙˆØ³Ø©","ØºÙ†Ù…","Ù…Ø§Ø¹Ø²","Ø¨Ø·Ø©","ÙˆØ²Ø©",
        "Ø³Ù…ÙƒØ©","ã‚¤ãƒ«ÙƒØ§","Ø­ÙˆØª","ØªÙ…Ø³Ø§Ø­","Ø«Ø¹Ø¨Ø§Ù†","Ø¹ØµÙÙˆØ±","Ù†Ø³Ø±","Ø¨ÙˆÙ…Ø©","Ø­Ù…Ø§Ù…Ø©","ØºØ±Ø§Ø¨",
        "Ø´Ø¬Ø±Ø©","Ù†Ø®Ù„Ø©","Ø²Ù‡Ø±Ø©","ÙˆØ±Ø¯Ø©","ØµØ¨Ø§Ø±","ØºØ§Ø¨Ø©","ØµØ­Ø±Ø§Ø¡","Ù†Ù‡Ø±","Ø¨Ø­ÙŠØ±Ø©","Ø¬Ø¨Ù„",

        // Ø¥Ø¶Ø§ÙØ§Øª Ø¹Ø§Ù…Ø©
        "ÙƒÙ…Ø¨ÙŠÙˆØªØ±","Ù…ÙˆØ¨Ø§ÙŠÙ„","ØªÙ„ÙØ²ÙŠÙˆÙ†","Ø±Ø§Ø¯ÙŠÙˆ","ÙƒØ§Ù…ÙŠØ±Ø§","ÙƒØªØ§Ø¨","Ø¯ÙØªØ±","Ù‚Ù„Ù…","ÙƒØ±Ø³ÙŠ","Ø·Ø§ÙˆÙ„Ø©",
        "Ø¨Ø§Ø¨","Ø´Ø¨Ø§Ùƒ","Ø³Ù‚Ù","Ø­Ø§Ø¦Ø·","Ø³Ø¬Ø§Ø¯Ø©","Ù…Ø±ÙˆØ­Ø©","ØªÙƒÙŠÙŠÙ","Ø«Ù„Ø§Ø¬Ø©","ØºØ³Ø§Ù„Ø©","Ø¨ÙˆØªØ¬Ø§Ø²"
        ];
    let votes = {};

    if (sessionStorage.getItem('players')) {
      players = JSON.parse(sessionStorage.getItem('players'));
      scores = JSON.parse(sessionStorage.getItem('scores'));
    }
    function applyAnimation() {
      gameEl.classList.remove('fade');
      void gameEl.offsetWidth;
      gameEl.classList.add('fade');
    }

    function shuffleArray(arr) {
      let a = [...arr];
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function startScreen() {
      gameEl.innerHTML = `
        <h2>Ø£Ø¯Ø®Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</h2>
        <input type="text" class="playerInput" id="playerName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨" />
        <button class="addButton" onclick="addPlayer()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„Ø§Ø¹Ø¨</button>
        <ul id="playersList"></ul>
        <button id="startBtn" onclick="startGame()" disabled>Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
        <button id="resetBtn" onclick="resetGame()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©</button>

      `;
      updatePlayersList();
      toggleStartButton();
      applyAnimation();
    }

    function addPlayer() {
      const name = document.getElementById('playerName').value.trim();
      if (name) {
        players.push(name);
        scores[name] = scores[name] || 0;
        document.getElementById('playerName').value = '';
        saveSession();
        updatePlayersList();
        toggleStartButton();
        applyAnimation();
      }
    }

    function updatePlayersList() {
      const list = document.getElementById('playersList');
      if (list) list.innerHTML = players.map(p => `<li>${p}</li>`).join('');
    }

    function toggleStartButton() {
      const btn = document.getElementById('startBtn');
      if (btn) btn.disabled = players.length < 3;
    }

    function saveSession() {
      sessionStorage.setItem('players', JSON.stringify(players));
      sessionStorage.setItem('scores', JSON.stringify(scores));
    }

    function startGame() {
      if (players.length < 3) {
        alert("Ù„Ø§Ø²Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ 3 Ù„Ø§Ø¹Ø¨ÙŠÙ†");
        return;
      }
      secretWord = words[Math.floor(Math.random() * words.length)];
      spyIndex = Math.floor(Math.random() * players.length);
      shuffledPlayers = shuffleArray(players);
      showPassScreen(0);
    }

    function showPassScreen(i) {
      gameEl.innerHTML = `
        <h2>Ø§Ù„Ø¯ÙˆØ±: ${shuffledPlayers[i]}</h2>
        <p>Ø£Ø¹Ø·Ù Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù„Ø§Ø¹Ø¨</p>
        <button id="nextBtn" onclick="showRole(${i})">Ø¬Ø§Ù‡Ø²</button>
      `;
      applyAnimation();
    }

    function showRole(i) {
      const playerName = shuffledPlayers[i];
      const isSpy = (players.indexOf(playerName) === spyIndex);
      gameEl.innerHTML = `
        <h2>Ø§Ù„Ø¯ÙˆØ±: ${playerName}</h2>
        <p>${isSpy ? "Ø£Ù†Øª Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ ğŸ•µï¸" : "Ø§Ù„ÙƒÙ„Ù…Ø©: <b>" + secretWord + "</b>"}</p>
        <button id="nextBtn" onclick="nextRole(${i})">ØªÙ…Ø§Ù…</button>
      `;
      applyAnimation();
    }

    function nextRole(i) {
      if (i + 1 < shuffledPlayers.length) {
        showPassScreen(i + 1);
      } else {
        startVotingIntro();
      }
      applyAnimation();
    }

    // function startVoting() {
    //   votes = {};
    //   gameEl.innerHTML = `<h2>Ø§Ù„ØªØµÙˆÙŠØª: Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ØŸ</h2>`;
    //   players.forEach(p => {
    //     gameEl.innerHTML += `
    //       <p>${p} ÙŠØ®ØªØ§Ø±:
    //         <select id="vote_${p}" class="customSelect" onchange="checkVotes()">
    //           <option value="">-- Ø§Ø®ØªØ± --</option>
    //           ${players.filter(op => op !== p).map(op => `<option>${op}</option>`).join('')}
    //         </select>
    //       </p>`;
    //   });
    //   gameEl.innerHTML += `<button id="revealBtn" onclick="showResult()" disabled>Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ØŸ</button>`;
    // }

    function checkVotes() {
      let allChosen = true;
      players.forEach(p => {
        const val = document.getElementById('vote_' + p).value;
        if (!val) allChosen = false;
      });
      document.getElementById('revealBtn').disabled = !allChosen;
    }


    function startVotingIntro() {
  gameEl.innerHTML = `
    <h2>ğŸ“¢ ÙˆÙ‚Øª Ø§Ù„ØªØµÙˆÙŠØª</h2>
    <p>Ù‡ÙŠÙ…Ø³Ùƒ ÙƒÙ„ Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø¹Ø´Ø§Ù† ÙŠØ®ØªØ§Ø± Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ Ù…Ù† ØºÙŠØ± Ù…Ø§ Ø­Ø¯ ÙŠØ´ÙˆÙ</p>
    <button onclick="showVoting(0)">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØµÙˆÙŠØª</button>
  `;
  applyAnimation();
}

function showVoting(i) {
  const player = players[i];
  gameEl.innerHTML = `
    <h2>ØªØµÙˆÙŠØª: ${player}</h2>
    <p>Ø§Ø®ØªØ± Ù…ÙŠÙ† ØªØ¸Ù† Ø§Ù†Ù‡ Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ ğŸ•µï¸</p>
    <select id="vote_${player}" class="customSelect">
      <option value="">-- Ø§Ø®ØªØ± --</option>
      ${players.filter(op => op !== player).map(op => `<option>${op}</option>`).join('')}
    </select>
    <br>
    <button id="nextVoteBtn" onclick="saveVote('${player}', ${i})">ØªÙ…Ø§Ù…</button>
  `;
  applyAnimation();
}

function saveVote(player, i) {
  const val = document.getElementById('vote_' + player).value;
  if (!val) {
    alert("Ù„Ø§Ø²Ù… ØªØ®ØªØ§Ø± Ø­Ø¯");
    return;
  }
  votes[player] = val;

  if (i + 1 < players.length) {
    showVoting(i + 1);
  } else {
    gameEl.innerHTML = `
      <h2>ØªÙ… Ø§Ù„ØªØµÙˆÙŠØª âœ…</h2>
      <p>Ø§Ø¶ØºØ· Ù„Ù…Ø¹Ø±ÙØ© Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ø³ÙˆØ³</p>
      <button id="revealBtn" onclick="showResult()">Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ØŸ</button>
    `;
    applyAnimation();
  }
}


function showResult() {
  const spyName = players[spyIndex];
  let resultHTML = `<h2>Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ Ù‡Ùˆ: ${spyName}</h2>`;

  players.forEach(p => {
    if (votes[p] === spyName) {
      scores[p] += 100;
    } else if (p === spyName && !Object.values(votes).includes(spyName)) {
      scores[p] += 100;
    }
  });

  saveSession();

  let sorted = Object.entries(scores).sort((a,b) => b[1] - a[1]);
  resultHTML += `<h3>Ø§Ù„Ù†ØªØ§Ø¦Ø¬:</h3><table>`;
  sorted.forEach(([name, score], idx) => {
    resultHTML += `<tr><td>${idx+1}</td><td>${name}</td><td>${score}</td></tr>`;
  });
  resultHTML += `</table>`;
  resultHTML += `
    <button onclick="startGame()">Ø¯ÙˆØ± Ø¬Ø¯ÙŠØ¯</button>
    <button onclick="resetGame()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
  `;
  gameEl.innerHTML = resultHTML;
  applyAnimation();
}


    function resetGame() {
      if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©ØŸ")) {
        sessionStorage.clear();
        players = [];
        scores = {};
        startScreen();
        applyAnimation();
      }
    }

    startScreen();
  </script>
</body>
</html>
